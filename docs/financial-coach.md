# SavQuest Financial Coach Documentation

## Overview

The SavQuest Financial Coach is an AI-powered financial assistant that helps users understand their finances, analyze spending patterns, and receive personalized financial advice. The coach uses a combination of mock data, simulated API calls, and OpenAI's GPT models to provide an interactive and educational experience.

## File Structure

```
savquest/
├── backend/
│   ├── app/
│   │   ├── api/
│   │   │   ├── api_v1/
│   │   │   │   ├── endpoints/
│   │   │   │   │   ├── coach.py         # Main backend logic for the financial coach
│   │   │   │   │   └── ...
│   │   ├── core/
│   │   │   ├── config.py                # Configuration including OpenAI API key
│   │   │   └── ...
│   ├── .env                             # Environment variables including API keys
├── frontend/
│   ├── src/
│   │   ├── pages/
│   │   │   ├── coach.jsx                # Financial coach chat interface
│   │   │   └── ...
│   │   ├── components/
│   │   │   ├── charts/
│   │   │   │   ├── PieChart.jsx         # Visualization for transaction data
│   │   │   │   ├── SubscriptionChart.jsx # Visualization for subscription data
│   │   │   │   └── ...
```

## Architecture

The Financial Coach consists of:

1. **Frontend**: React-based chat interface with visualization components
2. **Backend**: FastAPI endpoints that process user queries and generate responses
3. **Mock Data Services**: Simulated financial data and transaction history
4. **OpenAI Integration**: For generating personalized financial advice

## Core Features

### 1. General Financial Advice

The coach can answer general financial questions by analyzing the user's financial profile and providing personalized recommendations.

**Trigger**: Any message that doesn't match specific query patterns

**Process**:
- Formats the user's financial data into a prompt
- Calls OpenAI API with the prompt
- Returns the AI-generated response
- Falls back to rule-based responses if API fails

**Implementation**:
- Backend: `generate_ai_response()` function in `backend/app/api/api_v1/endpoints/coach.py`
- Frontend: General message handling in `frontend/src/pages/coach.jsx`

### 2. Transaction Search

The coach can search through transaction history to answer questions about specific spending categories or merchants.

**Trigger**: Messages containing keywords like "spend", "cost", "pay", "expense", "transaction"

**Process**:
- Shows a "Searching your transactions..." loading message
- Calls the backend to search mock transaction data
- Displays search results with total amount and time period
- Generates a pie chart visualization of spending by merchant
- Provides AI analysis of the spending pattern

**Example Query**: "How much did I spend at the gas station?"

**Implementation**:
- Backend: `search_transactions()` function in `backend/app/api/api_v1/endpoints/coach.py`
- Frontend: Transaction visualization in `frontend/src/components/charts/PieChart.jsx`

### 3. Subscription Analysis

The coach can analyze streaming service subscriptions and provide cost breakdowns and recommendations.

**Trigger**: Messages containing keywords like "netflix", "hulu", "disney", "spotify", "amazon prime", "subscription"

**Process**:
- Shows a multi-step loading process with animated indicators
- Step 1: "Fetching your subscription information..."
- Step 2: "Analyzing your spending patterns..."
- Calls a separate endpoint to get detailed subscription data
- Displays a bar chart visualization of subscription costs
- Provides AI analysis of subscription spending and recommendations

**Example Query**: "How much do I spend on Netflix, Hulu and Disney Plus?"

**Implementation**:
- Backend: 
  - `fetch_subscription_data()` and `analyze_subscriptions()` in `backend/app/api/api_v1/endpoints/coach.py`
  - `/subscription-analysis` endpoint
- Frontend: Subscription visualization in `frontend/src/components/charts/SubscriptionChart.jsx`

## Mock Data

Mock data is stored directly in the backend code:

1. **User Financial Data**: Generated by `get_mock_financial_data()` in `backend/app/api/api_v1/endpoints/coach.py`
   - Income, expenses, savings, debt information
   - Spending categories breakdown
   - Financial ratios (savings rate, debt-to-income)

2. **Transaction Data**: Generated by `get_mock_transactions()` in `backend/app/api/api_v1/endpoints/coach.py`
   - 6 months of transaction history
   - Merchant information
   - Transaction amounts and categories

3. **Subscription Data**: Generated by `fetch_subscription_data()` in `backend/app/api/api_v1/endpoints/coach.py`
   - Monthly and annual costs
   - Billing cycles
   - Last payment dates

## Custom Functions

### 1. `search_transactions(query, user_id)`

**Purpose**: Searches the user's transaction history for relevant transactions

**Called When**: User asks about spending on specific categories or merchants

**Returns**: 
- List of matching transactions
- Summary with total spent and time period
- Breakdown by merchant for visualization

**Location**: `backend/app/api/api_v1/endpoints/coach.py`

### 2. `fetch_subscription_data(user_id, services)`

**Purpose**: Retrieves detailed information about the user's streaming subscriptions

**Called When**: User asks about subscription costs

**Returns**:
- Monthly and annual cost for each service
- Billing cycle information
- Last payment dates

**Location**: `backend/app/api/api_v1/endpoints/coach.py`

### 3. `analyze_subscriptions(user_id, services)`

**Purpose**: Analyzes subscription spending in context of overall financial health

**Called When**: After subscription data is fetched

**Returns**:
- Percentage of income spent on subscriptions
- AI-generated recommendations
- Comparison to recommended entertainment budget percentages

**Location**: `backend/app/api/api_v1/endpoints/coach.py` (endpoint: `/subscription-analysis`)

### 4. `generate_ai_response(message, user, transaction_data)`

**Purpose**: Generates personalized financial advice using OpenAI

**Called When**: For all user queries

**Returns**: AI-generated response based on financial context

**Location**: `backend/app/api/api_v1/endpoints/coach.py`

## Visualization Components

### 1. `PieChart`

**Purpose**: Visualizes spending breakdown by category or merchant

**Used When**: Displaying transaction search results

**Features**:
- Color-coded segments
- Legend with amounts
- Total calculation

**Location**: `frontend/src/components/charts/PieChart.jsx`

### 2. `SubscriptionChart`

**Purpose**: Visualizes subscription costs with comparative bars

**Used When**: Displaying subscription analysis

**Features**:
- Horizontal bars showing relative costs
- Monthly and annual totals
- Last payment information

**Location**: `frontend/src/components/charts/SubscriptionChart.jsx`

## Configuration

The Financial Coach requires the following configuration:

1. **OpenAI API Key**: Set in `backend/.env` as `OPENAI_API_KEY`
2. **Default Model**: Set in `backend/app/api/api_v1/endpoints/coach.py` as `DEFAULT_MODEL` (default: "gpt-4o")

## Error Handling

The coach includes robust error handling:

1. **API Failures**: Falls back to rule-based responses if OpenAI API fails
2. **Transaction Search Errors**: Provides a generic response about spending patterns
3. **Subscription Analysis Errors**: Offers general advice about subscription management

## Frontend Implementation

The frontend chat interface (`frontend/src/pages/coach.jsx`) handles:

1. **Message Display**: Renders different message types (text, visualizations, loading states)
2. **User Input**: Processes user messages and sends them to the backend
3. **Loading States**: Shows animated indicators during data processing
4. **Suggested Questions**: Displays contextually relevant follow-up questions
5. **Conversation History**: Persists chat history in localStorage

## Future Enhancements

Potential improvements for the Financial Coach include:

1. **Real Banking Integration**: Replace mock data with actual user financial data
2. **Budget Recommendations**: Generate personalized budget plans
3. **Goal Tracking**: Help users set and track financial goals
4. **Investment Advice**: Provide basic investment education and recommendations
5. **Expense Categorization**: Automatically categorize and analyze expenses
6. **Savings Opportunities**: Identify potential areas to save money

## Technical Implementation Notes

- The coach uses a stateful chat interface that persists conversations in localStorage
- Loading states provide visual feedback during data processing
- The backend simulates API delays to create a realistic experience
- Suggested follow-up questions are dynamically generated based on context
- The coach can handle both specific financial queries and general advice requests

This implementation provides a compelling demo for hackathon purposes while demonstrating the potential for a more fully-featured financial coaching application. 